# 使用Webpack的目的
从文件森林中，找到重复使用的文件，在经过筛选之后将这些重复文件打包

# 基本原理
Webpack通过修改引用路径（修改import语句和全局变量的调用）的方式，
将文件中用到的模块或者全局变量，指向打包好的新文件。

# 术语

### 文件
默认情况下，Webpack只能处理JS文件，
但是在实际应用中，我们还有Css，Image等类型的文件需要处理。

不过本文主要侧重于JS文件的处理。因此后继描述中的文件，都只是JS文件。

Webpack认为文件根据来源分为两类：
- 本地文件（非lib文件）
- 第三方文件（在程序中使用的其他库）

根据不同来源的文件，Webpack可以采取不同的筛选方式，
找出符合需求的重复文件，再对其打包。

我们也可以根据自己的需求，使用test属性，定义自己的文件来源。

### 文件树，文件森林，入口，模块
相互依赖的模块之间是呈现树形结构的。
之所以不是网状结构，是因为前端页面每次只能有一个，因此调用总是从一个JS模块开始的。
这些相互依赖的模块就是文件树。

文件树的概念等效于模块。

文件树的根就是入口文件，Webpack认为根的来源只能有两种：
- 以异步方式"import('XXX.js')"导入的JS文件。
- Webpack配置文件中，entry指定的JS文件。

根文件是打包的起始点，Webpack就是从根文件开始，去查找依赖的。

异步方式导入又称按需导入。以异步方式导入的文件，往往是为了独立的功能，因此自身是独立的。
entry指定的文件，往往是页面启动时，用于初始化的文件，也是独立的。

前端系统就是由无数文件树来构成的，这些文件树构成了文件森林。

### 同步模块，异步模块
同步块是指以同步方式加载的文件。这些模块在ES6的代码中，通常是以import语句引入的。<br>
如： import 'XXX.js'

异步块的概念与同步块相对。主要是为了实现按需引入代码。通常是以import函数引入的。<br>
如： import('XXX.js')

异步模块只能作为文件树的根节点，同步模块才会被Webpack当成重复检查的对象。

### Chunk
经过Webpack打包好的文件，叫做Chunk。Chunk分为三类：
- 以入口文件为起始点的Chunk
- 以异步文件为起始点的Chunk
- 只包含重复文件的Chunk

### Loader
Webpack默认只能处理JS文件，但是前段还有CSS，Image，字体等类型的文件需要处理。
Webpack使用各种各样的Loader对这些非JS类型的文件进行处理。

### Plugins
插件用于以各种方式自定义webpack构建过程。
可以用来实现对打包文件分配进HTML代码，压缩打包文件等功能。

# 筛选
Webpack会从将如下条件，作为考虑筛选方式
- 文件来源
- 文件大小
- 重复次数
- 文件树最多能被拆分成多少个文件

需注意的是，这些条件之间是并列关系。

Webpack对来源不同的文件采取了不同的筛选策略

### 本地文件
对于本地文件，Webpack默认会将重复2次的文件进行打包。
如果需要打包的文件已经在其他Chunk中，就直接引用

### 第三方文件
对于第三方文件，默认只需要考虑需要打包的文件已经在其他Chunk中。
如果存在，就直接引用。

### 冲突解决
因为可以自定义文件来源，因此会出现一个文件同时满足多个筛选条件的情况，
我们可以设置priority属性，来决定优先考虑使用哪种来源的筛选条件。

### 排除文件
有些文件，可能需要由外部程序提供，这些文件不需要打包，
webpack使用externals属性，不对指定一些文件进行打包。

